########################################################################################################################
#                                        Coordinate frame and tf parameters
########################################################################################################################

# The global frame of the costmap to operate in
global_frame: map   # default: "/map" -> WARNING: Default value has a "/" in front of the frame-name

# The name of the frame for the base link of the robot
robot_base_frame: base_footprint    # default: "base_link"

# The footprint of the robot -> WARNING: According to ducumentation this parameter should not be loaded from parameter
# server but be subscribed to! However, it is required to run error - free
footprint: [[0.39,0.39],[-0.39,0.39],[-0.39,-0.39],[0.39,-0.39]]

# Specifies the delay in transform (tf) data that is tolerable in seconds
transform_tolerance: 0.4    # default: 0.2


########################################################################################################################
#                                                  Rate parameters
########################################################################################################################

# The frequency in Hz for the map to be updated
update_frequency: 10.0   # default: 5.0

# The frequency in Hz for the map to be publish display information.
publish_frequency: 10.0  # default: 0.0


########################################################################################################################
#                                             Map management parameters
########################################################################################################################

# Whether or not to use a rolling window version of the costmap
rolling_window: true  # default: false

# The parameters for the rolling_window (must be set if rolling_window = true)
width: 6.0         # default: 10
height: 6.0        # default: 10
resolution: 0.025   # default: 0.05
origin_x: 0.0       # default: 0.0
origin_y: 0.0       # default: 0.0

# Whether or not to use a static map (needs to be false if rolling_window = true)
static_map: false # default: true


########################################################################################################################
#                                                   Costmap Layers
########################################################################################################################

# The list of all the costmap layers that will be loaded
plugins:

# The static map layer represents a largely unchanging portion of the costmap, like those generated by SLAM.
- {name: static_layer, type: "costmap_2d::StaticLayer"}

# The obstacle layer tracks the obstacles as read by the sensor data.  The ObstacleCostmapPlugin marks and
# raytraces obstacles in two dimensions, while the VoxelCostmapPlugin does so in three dimensions.
- {name: obstacle_layer,  type: "costmap_2d::ObstacleLayer"}
- {name: obstacle_layer_2, type: "costmap_2d::ObstacleLayer"}
- {name: obstacle_layer_3, type: "costmap_2d::ObstacleLayer"}

# The virtual obstacle layer puts virtual obstacles on the costmap by reading polygons from a yaml-file and from a topic.
- {name: virtual_obstacle_layer,  type: "virtual_obstacle_layer_namespace::VirtualObstacleLayer"}

# The inflation layer is an optimization that adds new values around lethal obstacles (i.e. inflates the obstacles)
# in order to make the costmap represent the configuration space of the robot.
- {name: inflation_layer,   type: "costmap_2d::InflationLayer"}


########################################################################################################################
#                                            Static Map/Layer Parameters
########################################################################################################################

static_layer:

  # The value for which a cost should be considered unknown when reading in a map from the map server
  unknown_cost_value: 0   # default: 0

  # The threshold value at which to consider a cost lethal when reading in a map from the map server
  lethal_cost_threshold: 100  # default: 100

  # The topic that the costmap subscribes to for the static map. This parameter is useful when you have multiple
  # costmap instances within a single node that you want to use different static maps.
  map_topic: map  # default: "map"


########################################################################################################################
#                                           Obstacle/Voxel Layer Paramters
########################################################################################################################

obstacle_layer:

  # Definition of the sensors/observation sources
  observation_sources: laser_scan_combined #laser_scan_left laser_scan_right

  # Parameters of the source: laser_scan_front
  laser_scan_combined:
    sensor_frame: base_link             # The frame of the origin of the sensor, default: ""
    topic: /costmap_scan_filtered       # The topic on which sensor data comes in for this source, default: source_name
    data_type: LaserScan                # The data type associated with the topic, default: "PointCloud"
    marking: true                       # Whether or not this observation is used to mark obstacles, default: true
    clearing: true                      # Whether or not this observation is used to clear out freespace, default: false

#  laser_scan_left:
#    sensor_frame: base_laser_left_link  # The frame of the origin of the sensor, default: ""
#    topic: /base_laser_left/scan        # The topic on which sensor data comes in for this source, default: source_name
#    data_type: LaserScan                # The data type associated with the topic, default: "PointCloud"
#    marking: true                       # Whether or not this observation is used to mark obstacles, default: true
#    clearing: true                      # Whether or not this observation is used to clear out freespace, default: false

#  laser_scan_right:
#    sensor_frame: base_laser_right_link # The frame of the origin of the sensor, default: ""
#    topic: /base_laser_right/scan       # The topic on which sensor data comes in for this source, default: source_name
#    data_type: LaserScan                # The data type associated with the topic, default: "PointCloud"
#    marking: true                       # Whether or not this observation is used to mark obstacles, default: true
#    clearing: true                      # Whether or not this observation is used to clear out freespace, default: false
 

  # The default maximum distance from the robot at which an obstacle will be inserted into the cost map in meters
  obstacle_range: 15.0  # default: 2.5

  # The default range in meters at which to raytrace out obstacles from the map using sensor data
  raytrace_range: 15.0  # default: 3.0

  # Voxel Parameter: The z origin of the map in meters
  origin_z: 0.0   # default: 0.0

  # Voxel Parameter: The z resolution of the map in meters/cell
  z_resolution: 0.1125  # default: 0.2

  # Voxel Parameter: The number of voxels to in each vertical column, the height of the grid is z_resolution * z_voxels
  z_voxels: 16  # default: 10

  # Voxel Parameter: The number of unknown cells allowed in a column considered to be "known"
  unknown_threshold: 8  # default: ~<name>/z_voxels

  # Voxel Parameter: The maximum number of marked cells allowed in a column considered to be "free"
  mark_threshold: 0   # default: 0

  # disable footprint clearing
  footprint_clearing_enabled: false

obstacle_layer_2:

  # Definition of the sensors/observation sources
  observation_sources: torso_cam3d_left torso_cam3d_right

  # Parameters of the source: laser_scan_front
  torso_cam3d_left:
    sensor_frame: base_link             # The frame of the origin of the sensor, default: ""
    topic: /torso_cam3d_left/scan       # The topic on which sensor data comes in for this source, default: source_name
    data_type: LaserScan                # The data type associated with the topic, default: "PointCloud"
    marking: true                       # Whether or not this observation is used to mark obstacles, default: true
    clearing: true                      # Whether or not this observation is used to clear out freespace, default: false

  torso_cam3d_right:
    sensor_frame: base_link             # The frame of the origin of the sensor, default: ""
    topic: /torso_cam3d_right/scan      # The topic on which sensor data comes in for this source, default: source_name
    data_type: LaserScan                # The data type associated with the topic, default: "PointCloud"
    marking: true                       # Whether or not this observation is used to mark obstacles, default: true
    clearing: true                      # Whether or not this observation is used to clear out freespace, default: false

  # Voxel Parameter: The z origin of the map in meters
  origin_z: 0.0   # default: 0.0

  # Voxel Parameter: The z resolution of the map in meters/cell
  z_resolution: 0.1125  # default: 0.2

  # Voxel Parameter: The number of voxels to in each vertical column, the height of the grid is z_resolution * z_voxels
  z_voxels: 16  # default: 10

  # The default maximum distance from the robot at which an obstacle will be inserted into the cost map in meters
  obstacle_range: 4.0  # default: 2.5

  # The default range in meters at which to raytrace out obstacles from the map using sensor data
  raytrace_range: 5.0  # default: 3.0

  # Voxel Parameter: The number of unknown cells allowed in a column considered to be "known"
  unknown_threshold: 8  # default: ~<name>/z_voxels

  # Voxel Parameter: The maximum number of marked cells allowed in a column considered to be "free"
  mark_threshold: 0   # default: 0

obstacle_layer_3: # Layer for the realsense camera torso down

  # Definition of the sensors/observation sources
  observation_sources: torso_cam3d_down

  # Parameters of the source
  torso_cam3d_down:
    sensor_frame: base_link             # The frame of the origin of the sensor, default: ""
    topic: /torso_cam3d_down/scan       # The topic on which sensor data comes in for this source, default: source_name
    data_type: LaserScan                # The data type associated with the topic, default: "PointCloud"
    marking: true                       # Whether or not this observation is used to mark obstacles, default: true
    clearing: true                      # Whether or not this observation is used to clear out freespace, default: false

  # Voxel Parameter: The z origin of the map in meters
  origin_z: 0.0   # default: 0.0

  # Voxel Parameter: The z resolution of the map in meters/cell
  z_resolution: 0.1125  # default: 0.2

  # Voxel Parameter: The number of voxels to in each vertical column, the height of the grid is z_resolution * z_voxels
  z_voxels: 16  # default: 10

  # The default maximum distance from the robot at which an obstacle will be inserted into the cost map in meters
  obstacle_range: 4.0  # default: 2.5

  # The default range in meters at which to raytrace out obstacles from the map using sensor data
  raytrace_range: 5.0  # default: 3.0

  # Voxel Parameter: The number of unknown cells allowed in a column considered to be "known"
  unknown_threshold: 8  # default: ~<name>/z_voxels

  # Voxel Parameter: The maximum number of marked cells allowed in a column considered to be "free"
  mark_threshold: 0 # default: 0

########################################################################################################################
#                                             Inflation Layer Parameters
########################################################################################################################

inflation_layer:

  # The radius in meters to which the map inflates obstacle cost values.
  inflation_radius: 0.8  # default: 0.55

  # A scaling factor to apply to cost values during inflation.
  cost_scaling_factor: 6.92   # default: 10.0


########################################################################################################################
#                                             Virtual Obstacle Layer Parameters
########################################################################################################################

virtual_obstacle_layer:

  enabled: true

  # polygon_file_address is defined in the launch file as it depends on ROBOT and ROBOT_ENV
